```html
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math Duel Arena ‚Äì Pink Edition</title>

<style>
:root{
    --pink1:#ffd6f3;
    --pink2:#ffc2ec;
    --pink3:#ff9de2;
    --purple:#d8b4ff;
    --blue:#bde7ff;
    --text:#5b2b6a;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
    margin:0;
    font-family:"Segoe UI", "Tahoma", sans-serif;
    background:linear-gradient(135deg,var(--pink1),var(--purple),var(--blue));
    background-size:300% 300%;
    animation:bgMove 12s ease infinite;
    color:var(--text);
    overflow:hidden;
}
@keyframes bgMove{
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
}
.screen{
    position:absolute;
    inset:0;
    padding:20px;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    opacity:0;
    transform:translateY(20px);
    transition:all .35s ease;
    pointer-events:none;
}
.screen.active{
    opacity:1;
    transform:translateY(0);
    pointer-events:auto;
}
h1{
    font-size:2rem;
    margin-bottom:20px;
    text-align:center;
    text-shadow:0 0 15px white;
}
.btn{
    width:260px;
    padding:14px;
    margin:8px;
    border:none;
    border-radius:30px;
    background:linear-gradient(135deg,var(--pink2),var(--pink3));
    color:white;
    font-size:1rem;
    cursor:pointer;
    position:relative;
    overflow:hidden;
    transition:.2s;
    box-shadow:0 6px 20px rgba(255,150,220,.5);
}
.btn:hover{transform:scale(1.05);box-shadow:0 0 25px white}
.btn:active{transform:scale(.95)}
.back{
    position:absolute;
    top:10px;
    left:10px;
    width:120px;
}
.choice-grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
    margin-top:15px;
}
.choice{
    padding:12px;
    border-radius:20px;
    background:rgba(255,255,255,.6);
    text-align:center;
    cursor:pointer;
    transition:.2s;
}
.choice:hover{transform:scale(1.05)}
.status{
    width:100%;
    max-width:500px;
    display:flex;
    justify-content:space-between;
    margin-bottom:10px;
}
.hpbar{
    height:15px;
    background:white;
    border-radius:20px;
    overflow:hidden;
}
.hp{
    height:100%;
    width:100%;
    background:linear-gradient(90deg,var(--pink3),var(--purple));
    transition:width .3s ease;
}
.question{
    font-size:1.4rem;
    margin:10px 0;
    text-align:center;
}
.small{
    font-size:.9rem;
}
.heart{
    position:absolute;
    width:12px;height:12px;
    background:var(--pink3);
    transform:rotate(45deg);
    opacity:.6;
}
.heart:before,.heart:after{
    content:"";
    position:absolute;
    width:12px;height:12px;
    background:var(--pink3);
    border-radius:50%;
}
.heart:before{top:-6px;left:0}
.heart:after{left:-6px;top:0}
@media(max-width:600px){
    .btn{width:90%}
}
</style>
</head>
<body>

<div id="mainMenu" class="screen active">
<h1>‡∏®‡∏∂‡∏Å‡∏î‡∏ß‡∏•‡∏Ñ‡∏ì‡∏¥‡∏ï 4 ‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πâ‡∏≤</h1>
<button class="btn" onclick="showScreen('aiMenu')">‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</button>
<button class="btn" onclick="showScreen('friendMenu')">‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</button>
<button class="btn" onclick="showScreen('survivalMenu')">‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î</button>
<button class="btn" onclick="showScreen('statsScreen')">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</button>
<button class="btn" onclick="showScreen('settingsScreen')">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
<button class="btn" onclick="showScreen('howScreen')">‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</button>
</div>

<div id="aiMenu" class="screen">
<button class="btn back" onclick="showScreen('mainMenu')">üîô ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
<h1>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î AI</h1>
<div>
<p>‡∏£‡∏∞‡∏î‡∏±‡∏ö AI</p>
<select id="aiLevel">
<option>‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà</option>
<option>‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
<option>‡πÇ‡∏õ‡∏£</option>
<option>‡∏ï‡∏≥‡∏ô‡∏≤‡∏ô</option>
</select>
<p>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ì‡∏¥‡∏ï</p>
<select id="mathLevelAI">
<option>‡∏õ‡∏£‡∏∞‡∏ñ‡∏°</option>
<option>‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏ï‡πâ‡∏ô</option>
<option>‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏õ‡∏•‡∏≤‡∏¢</option>
</select>
</div>
<button class="btn" onclick="startAI()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
</div>

<div id="friendMenu" class="screen">
<button class="btn back" onclick="showScreen('mainMenu')">üîô ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
<h1>‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</h1>
<p>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</p>
<select id="playerCount">
<option>2</option>
<option>3</option>
<option>4</option>
</select>
<p>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ì‡∏¥‡∏ï</p>
<select id="mathLevelFriend">
<option>‡∏õ‡∏£‡∏∞‡∏ñ‡∏°</option>
<option>‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏ï‡πâ‡∏ô</option>
<option>‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏õ‡∏•‡∏≤‡∏¢</option>
</select>
<button class="btn" onclick="startFriend()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
</div>

<div id="survivalMenu" class="screen">
<button class="btn back" onclick="showScreen('mainMenu')">üîô ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
<h1>‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î</h1>
<button class="btn" onclick="startSurvival()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢</button>
</div>

<div id="statsScreen" class="screen">
<button class="btn back" onclick="showScreen('mainMenu')">üîô ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
<h1>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h1>
<div id="statsBox"></div>
</div>

<div id="settingsScreen" class="screen">
<button class="btn back" onclick="showScreen('mainMenu')">üîô ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
<h1>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h1>
<label><input type="checkbox" id="soundToggle" checked> ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á</label><br>
<label><input type="checkbox" id="effectToggle" checked> ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå</label><br>
<button class="btn" onclick="resetStats()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</button>
</div>

<div id="howScreen" class="screen">
<button class="btn back" onclick="showScreen('mainMenu')">üîô ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
<h1>‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</h1>
<p class="small">
‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π<br>
‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î‡∏à‡∏∞‡πÄ‡∏™‡∏µ‡∏¢ HP<br>
‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏£‡∏á<br>
‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà HP ‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∞‡πÅ‡∏û‡πâ
</p>
</div>

<div id="gameScreen" class="screen">
<button class="btn back" onclick="endGame()">üîô ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°</button>
<div class="status">
<div style="width:48%">
<div>‡∏Ñ‡∏∏‡∏ì</div>
<div class="hpbar"><div id="hp1" class="hp"></div></div>
</div>
<div style="width:48%">
<div id="enemyName">‡∏®‡∏±‡∏ï‡∏£‡∏π</div>
<div class="hpbar"><div id="hp2" class="hp"></div></div>
</div>
</div>
<div id="question" class="question"></div>
<div id="choices" class="choice-grid"></div>
</div>

<script>
let currentScreen="mainMenu";
function showScreen(id){
document.getElementById(currentScreen).classList.remove("active");
currentScreen=id;
document.getElementById(id).classList.add("active");
if(id==="statsScreen") loadStats();
}

function heartLoop(){
if(!document.getElementById("effectToggle").checked) return;
const h=document.createElement("div");
h.className="heart";
h.style.left=Math.random()*100+"%";
h.style.top="100%";
document.body.appendChild(h);
let y=100;
function anim(){
y-=0.3;
h.style.top=y+"%";
if(y< -10) h.remove();
else requestAnimationFrame(anim);
}
requestAnimationFrame(anim);
}
setInterval(heartLoop,800);

class Player{
constructor(name){
this.name=name;
this.hp=100;
this.combo=0;
}
}

let p1,p2,mode="AI",mathLevel="‡∏õ‡∏£‡∏∞‡∏ñ‡∏°",aiConfig=null;
let startTime=0;

function startAI(){
mode="AI";
mathLevel=document.getElementById("mathLevelAI").value;
let lvl=document.getElementById("aiLevel").value;
aiConfig={
"‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà":{time:2500,acc:.6},
"‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á":{time:1800,acc:.75},
"‡πÇ‡∏õ‡∏£":{time:1200,acc:.9},
"‡∏ï‡∏≥‡∏ô‡∏≤‡∏ô":{time:800,acc:.97}
}[lvl];
p1=new Player("‡∏Ñ‡∏∏‡∏ì");
p2=new Player("AI");
document.getElementById("enemyName").innerText="AI";
showScreen("gameScreen");
nextQuestion();
}

function startFriend(){
mode="FRIEND";
mathLevel=document.getElementById("mathLevelFriend").value;
p1=new Player("‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô1");
p2=new Player("‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô2");
document.getElementById("enemyName").innerText="‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô2";
showScreen("gameScreen");
nextQuestion();
}

function startSurvival(){
mode="SURVIVAL";
mathLevel="‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏ï‡πâ‡∏ô";
p1=new Player("‡∏Ñ‡∏∏‡∏ì");
p2=new Player("‡∏ö‡∏≠‡∏™");
document.getElementById("enemyName").innerText="‡∏ö‡∏≠‡∏™";
showScreen("gameScreen");
nextQuestion();
}

function generateQuestion(){
let a=Math.floor(Math.random()*10)+1;
let b=Math.floor(Math.random()*10)+1;
let correct=a+b;
if(mathLevel==="‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏ï‡πâ‡∏ô") correct=a*b;
if(mathLevel==="‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏õ‡∏•‡∏≤‡∏¢") correct=a*a + b;
let choices=[correct];
while(choices.length<4){
let wrong=correct+Math.floor(Math.random()*10-5);
if(!choices.includes(wrong)) choices.push(wrong);
}
choices.sort(()=>Math.random()-0.5);
return {text:`${a} ${mathLevel==="‡∏õ‡∏£‡∏∞‡∏ñ‡∏°"?"+":mathLevel==="‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏ï‡πâ‡∏ô"?"√ó":"¬≤+"} ${b} = ?`,correct,choices};
}

function nextQuestion(){
const q=generateQuestion();
document.getElementById("question").innerText=q.text;
const box=document.getElementById("choices");
box.innerHTML="";
q.choices.forEach(c=>{
let div=document.createElement("div");
div.className="choice";
div.innerText=c;
div.onclick=()=>answer(c===q.correct);
box.appendChild(div);
});
startTime=performance.now();
if(mode==="AI"){
setTimeout(()=>{
if(Math.random()<aiConfig.acc){
damage(p1,p2);
}else{
damage(p2,p2);
}
},aiConfig.time);
}
}

function answer(correct){
let time=(performance.now()-startTime)/1000;
if(correct){
damage(p2,p1,time);
}else{
damage(p1,p1,time);
}
}

function damage(target,attacker,time=1){
let base=10;
let speedBonus=Math.max(0,5-time*2);
attacker.combo++;
let multi=1;
if(attacker.combo>=5) multi=2;
else if(attacker.combo>=3) multi=1.5;
else if(attacker.combo>=2) multi=1.2;
let dmg=(base+speedBonus)*multi;
if(target===attacker) attacker.combo=0;
target.hp-=dmg;
if(target.hp<0) target.hp=0;
updateHP();
if(target.hp<=0){
saveStats(attacker.name==="‡∏Ñ‡∏∏‡∏ì");
setTimeout(()=>alert(attacker.name+" ‡∏ä‡∏ô‡∏∞!"),200);
endGame();
}else{
setTimeout(nextQuestion,500);
}
}

function updateHP(){
document.getElementById("hp1").style.width=p1.hp+"%";
document.getElementById("hp2").style.width=p2.hp+"%";
}

function endGame(){
showScreen("mainMenu");
}

function saveStats(win){
let s=JSON.parse(localStorage.getItem("mathStats")||"{}");
s.games=(s.games||0)+1;
if(win) s.wins=(s.wins||0)+1;
localStorage.setItem("mathStats",JSON.stringify(s));
}

function loadStats(){
let s=JSON.parse(localStorage.getItem("mathStats")||"{}");
document.getElementById("statsBox").innerHTML=
"‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Å‡∏°: "+(s.games||0)+"<br>‡∏ä‡∏ô‡∏∞: "+(s.wins||0);
}

function resetStats(){
localStorage.removeItem("mathStats");
alert("‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÅ‡∏•‡πâ‡∏ß");
}
</script>
</body>
</html>
```
